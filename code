Tidymodels examples
Stratfy on the outcome so it can balance the outcome to avoid misifting models
```{r}
library(tidymodels)
library(dplyr)
mpg_split = initial_split(mpg, prop = .75, strata = hwy)
mpg_training =  mpg_split %>%
  training()
mpg_training

mpg_test = mpg_split %>%
  testing()
mpg_test

lm_model = linear_reg() %>%
  set_engine("lm") %>%
  #Classifcation or regression
  set_mode("regression")

lm_fit = lm_model %>%
  fit(hwy ~ cty, data = mpg_training)
tidy_fit = lm_fit %>%
  tidy() %>%
  mutate_if(is.numeric, round, 2)
tidy_fit
hwy_preds = lm_fit %>%
  predict(new_data = mpg_test)
hwy_preds

### Create a results data set
hwy_results = mpg_test %>%
  select(cty, hwy) %>%
  bind_cols(hwy_preds)
hwy_results

#### Does it all in one
lm_last_fit = lm_model %>%
  last_fit(hwy ~ cty, split = mpg_split)
lm_last_fit %>%
  collect_metrics()
```
